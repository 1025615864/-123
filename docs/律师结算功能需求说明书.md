文档名称： 律师结算功能需求说明书（MVP 版本）

项目名称： 百姓法律助手

版本： v1.0

日期： [填写日期]

编制： [甲方公司名称]

一、功能概述
1.1 背景与必要性
律师结算/提现功能是平台商业闭环的最后一环。没有此功能：

律师无法获得服务收入
律师无动力入驻和提供服务
平台无法实现商业化运营
1.2 功能目标
实现律师服务收入的记录、查询、提现申请和发放的完整闭环，确保：

律师可查看收入明细
律师可申请提现
平台可审核并处理提现
资金流转清晰可追溯
1.3 MVP 范围定义
本需求说明书定义的是最小可用版本（MVP），目标是以最小开发成本实现业务闭环，后续可迭代增强。

二、角色与权限
角色 权限
律师 查看收入、申请提现、查看提现记录
管理员 审核提现、人工打款、查看所有记录
系统 自动记录收入、计算可提现金额
三、业务规则
3.1 收入规则
规则项 说明
收入来源 用户支付的咨询服务费
平台抽成 [X]%（建议：15%-20%）
律师分成 [100-X]%（建议：80%-85%）
收入确认时机 咨询状态变为"已完成"后
冻结期 收入确认后[X]天可提现（建议：7 天）
3.2 提现规则
规则项 说明
最低提现金额 [X]元（建议：100 元）
单次最高提现 [X]元（建议：50000 元）
提现手续费 [X]元/笔 或 [X]%（建议：0 元或 2 元/笔）
提现周期 每月[X]次（建议：不限次数）
到账时间 审核通过后[X]个工作日（建议：3 个工作日）
3.3 提现方式（MVP）
方式 MVP 支持 说明
银行卡转账 ✅ 人工打款，需律师绑定银行卡
支付宝转账 ⭕ 可选 人工打款，需律师绑定支付宝
微信转账 ❌ 二期 需对接企业付款接口
四、功能详细说明
4.1 律师收入账户
4.1.1 数据模型
text

LawyerWallet（律师钱包）
├── lawyer_id: 律师 ID
├── total_income: 累计收入
├── withdrawn_amount: 已提现金额
├── pending_amount: 待结算金额（冻结期内）
├── available_amount: 可提现金额
├── frozen_amount: 冻结金额（提现审核中）
├── created_at: 创建时间
└── updated_at: 更新时间
4.1.2 金额计算规则
text

可提现金额 = 累计收入 - 已提现金额 - 待结算金额 - 冻结金额
4.2 收入记录
4.2.1 数据模型
text

LawyerIncomeRecord（收入记录）
├── id: 记录 ID
├── lawyer_id: 律师 ID
├── consultation_id: 关联咨询 ID
├── order_no: 关联订单号
├── user_paid_amount: 用户支付金额
├── platform_fee: 平台抽成
├── lawyer_income: 律师收入
├── status: 状态（pending/settled/withdrawn）
├── settle_time: 可结算时间（冻结期结束时间）
├── created_at: 创建时间
└── updated_at: 更新时间
4.2.2 状态流转
text

pending（待结算）
↓ 冻结期结束
settled（已结算，可提现）
↓ 提现成功
withdrawn（已提现）
4.3 提现申请
4.3.1 数据模型
text

WithdrawalRequest（提现申请）
├── id: 申请 ID
├── request_no: 申请单号（唯一）
├── lawyer_id: 律师 ID
├── amount: 提现金额
├── fee: 手续费
├── actual_amount: 实际到账金额
├── withdraw_method: 提现方式（bank_card/alipay）
├── account_info: 收款账户信息（JSON，含银行/账号/户名）
├── status: 状态（pending/approved/rejected/completed/failed）
├── reject_reason: 驳回原因
├── admin_id: 审核人 ID
├── reviewed_at: 审核时间
├── completed_at: 完成时间
├── remark: 备注
├── created_at: 创建时间
└── updated_at: 更新时间
4.3.2 状态流转
text

pending（待审核）
↓ 管理员审核
approved（审核通过，待打款） ←→ rejected（已驳回）
↓ 打款完成
completed（已完成）
或
failed（打款失败）
4.4 银行卡绑定
4.4.1 数据模型
text

LawyerBankAccount（律师银行账户）
├── id: 记录 ID
├── lawyer_id: 律师 ID
├── account_type: 账户类型（bank_card/alipay）
├── bank_name: 银行名称
├── bank_branch: 开户支行
├── account_no: 账号（加密存储）
├── account_name: 户名
├── is_default: 是否默认
├── status: 状态（active/disabled）
├── created_at: 创建时间
└── updated_at: 更新时间
五、页面与接口设计
5.1 律师端页面
5.1.1 收入概览页（/lawyer/income）
页面内容：

text

┌─────────────────────────────────────────────────┐
│ 我的收入 │
├─────────────────────────────────────────────────┤
│ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌────────┐ │
│ │ 累计收入 │ │ 可提现 │ │ 待结算 │ │ 已提现 │ │
│ │¥12,580 │ │¥8,200 │ │¥2,380 │ │¥2,000 │ │
│ └─────────┘ └─────────┘ └─────────┘ └────────┘ │
│ [申请提现] │
├─────────────────────────────────────────────────┤
│ 收入明细 [筛选] [导出]│
├─────────────────────────────────────────────────┤
│ 日期 来源 用户支付 平台抽成 我的收入 │
│ 2026-01-04 张先生咨询 ¥200 ¥30 ¥170 │
│ 2026-01-03 李女士咨询 ¥500 ¥75 ¥425 │
│ ... │
└─────────────────────────────────────────────────┘
5.1.2 提现申请页（/lawyer/withdraw）
页面内容：

text

┌─────────────────────────────────────────────────┐
│ 申请提现 │
├─────────────────────────────────────────────────┤
│ 可提现金额：¥8,200.00 │
│ │
│ 提现金额：[________] 元 [全部提现] │
│ │
│ 提现方式：○ 银行卡 ○ 支付宝 │
│ │
│ 收款账户： │
│ ┌─────────────────────────────────────────┐ │
│ │ 工商银行 尾号 8888 张律师 │ │
│ │ [默认] [更换] │ │
│ └─────────────────────────────────────────┘ │
│ │
│ 手续费：¥0.00 │
│ 实际到账：¥[____] │
│ │
│ 预计到账时间：3 个工作日内 │
│ │
│ [确认提现] │
└─────────────────────────────────────────────────┘
5.1.3 提现记录页（/lawyer/withdrawals）
页面内容：

text

┌─────────────────────────────────────────────────┐
│ 提现记录 │
├─────────────────────────────────────────────────┤
│ 申请时间 金额 状态 操作 │
│ 2026-01-02 ¥2,000 已完成 [查看详情] │
│ 2025-12-20 ¥1,500 已完成 [查看详情] │
│ ... │
└─────────────────────────────────────────────────┘
5.1.4 银行卡管理页（/lawyer/bank-accounts）
页面内容：

已绑定银行卡列表
添加银行卡
设置默认银行卡
删除银行卡
5.2 管理端页面
5.2.1 提现审核页（/admin/withdrawals）
页面内容：

text

┌─────────────────────────────────────────────────────────────┐
│ 提现审核 │
├─────────────────────────────────────────────────────────────┤
│ [待审核] [已审核] [全部] [搜索律师/单号] │
├─────────────────────────────────────────────────────────────┤
│ 申请单号 律师 金额 申请时间 状态 操作 │
│ W202601... 张律师 ¥2,000 01-04 10:30 待审核 [审核] │
│ W202601... 李律师 ¥5,000 01-03 15:20 已通过 [打款] │
│ ... │
└─────────────────────────────────────────────────────────────┘
5.2.2 审核弹窗
text

┌─────────────────────────────────────────────────┐
│ 提现审核 │
├─────────────────────────────────────────────────┤
│ 申请单号：W20260104001 │
│ 律师：张律师 │
│ 提现金额：¥2,000.00 │
│ 收款账户：工商银行 6222**\*\*\*\***8888 张某某 │
│ │
│ ┌─────────────────────────────────────────┐ │
│ │ 收入核对： │ │
│ │ - 累计收入：¥12,580 │ │
│ │ - 已提现：¥2,000 │ │
│ │ - 待结算：¥2,380 │ │
│ │ - 可提现：¥8,200 ✓ │ │
│ └─────────────────────────────────────────┘ │
│ │
│ 审核意见：[________________] │
│ │
│ [驳回] [通过] │
└─────────────────────────────────────────────────┘
5.2.3 结算统计页（/admin/settlement-stats）
统计内容：

待审核提现笔数/金额
本月提现笔数/金额
平台抽成收入统计
律师收入排行
5.3 后端接口
5.3.1 律师端接口
接口 方法 说明
/api/lawyer/wallet GET 获取钱包信息
/api/lawyer/income-records GET 获取收入记录列表
/api/lawyer/income-records/export GET 导出收入记录
/api/lawyer/withdrawals GET 获取提现记录列表
/api/lawyer/withdrawals POST 提交提现申请
/api/lawyer/withdrawals/{id} GET 获取提现详情
/api/lawyer/bank-accounts GET 获取银行卡列表
/api/lawyer/bank-accounts POST 添加银行卡
/api/lawyer/bank-accounts/{id} PUT 更新银行卡
/api/lawyer/bank-accounts/{id} DELETE 删除银行卡
/api/lawyer/bank-accounts/{id}/default PUT 设为默认
5.3.2 管理端接口
接口 方法 说明
/api/admin/withdrawals GET 获取提现申请列表
/api/admin/withdrawals/{id} GET 获取提现详情
/api/admin/withdrawals/{id}/approve POST 审核通过
/api/admin/withdrawals/{id}/reject POST 审核驳回
/api/admin/withdrawals/{id}/complete POST 标记打款完成
/api/admin/withdrawals/{id}/fail POST 标记打款失败
/api/admin/settlement-stats GET 获取结算统计
/api/admin/lawyer-wallets GET 获取律师钱包列表
六、系统自动任务
6.1 收入结算任务
任务 执行频率 说明
收入确认 咨询完成时触发 创建收入记录，状态为 pending
冻结期解除 每日凌晨执行 将到期的 pending 记录更新为 settled
6.2 触发逻辑
Python

# 咨询完成时触发

def on_consultation_completed(consultation): # 计算分成
user_paid = consultation.order.paid_amount
platform_fee = user_paid \* PLATFORM_FEE_RATE
lawyer_income = user_paid - platform_fee

    # 创建收入记录
    create_income_record(
        lawyer_id=consultation.lawyer_id,
        consultation_id=consultation.id,
        user_paid_amount=user_paid,
        platform_fee=platform_fee,
        lawyer_income=lawyer_income,
        status='pending',
        settle_time=now() + FREEZE_DAYS
    )

    # 更新律师钱包待结算金额
    update_lawyer_wallet(
        lawyer_id=consultation.lawyer_id,
        pending_amount_delta=lawyer_income
    )

七、验收标准
7.1 功能验收
序号 验收项 验收标准
1 收入记录生成 咨询完成后自动生成收入记录
2 金额计算正确 分成比例计算正确，无精度丢失
3 冻结期生效 冻结期内金额不可提现
4 提现申请 可正常提交，金额校验生效
5 管理员审核 可通过/驳回，状态变更正确
6 打款标记 可标记完成/失败，金额变更正确
7 银行卡管理 增删改查正常，默认设置生效
7.2 数据验收
序号 验收项 验收标准
1 金额一致性 钱包金额 = 收入记录汇总
2 状态一致性 提现金额 = 已完成提现记录汇总
3 审计追溯 所有操作有日志记录
八、时间要求
阶段 时间要求
需求确认 对接会议后 2 个工作日内
开发完成 需求确认后[X]个工作日内
联调测试 开发完成后 3 个工作日内
验收上线 联调通过后 2 个工作日内
九、附录：业务规则确认单
请开发方确认以下业务规则（甲方建议值）：

规则项 甲方建议 开发方确认
平台抽成比例 15% □ 同意 □ 建议：\_**\_
冻结期 7 天 □ 同意 □ 建议：\_\_**
最低提现金额 100 元 □ 同意 □ 建议：\_**\_
单次最高提现 50000 元 □ 同意 □ 建议：\_\_**
提现手续费 0 元 □ 同意 □ 建议：\_**\_
到账时间承诺 3 个工作日 □ 同意 □ 建议：\_\_**
