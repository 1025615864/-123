# 项目问题反馈回复函（2.0 交付核验版）

---

**致：** [甲方公司名称/联系人]  
**自：** [开发公司名称/联系人]  
**日期：** [填写日期]  
**主题：** 关于“百姓法律助手（百姓助手）v1.0”交付物问题反馈及整改/二期建议的回复（2.0）

---

## 一、说明与总体结论

我方已收到贵方《项目问题反馈函》，感谢贵方对交付物的评估与测试。

针对反馈中提出的“业务闭环不完整、商业化能力不足、知识库/RAG 落地不清晰、合规与用户侧基础能力缺失”等问题，我方已对照当前代码、前端页面入口与后端接口进行核验，并在本函中按“可验收现状 / 待补齐项 / 甲方需配合”口径逐项回复。

为避免双方对“交付范围”产生偏差，建议后续回复与计划分为两类：

1.  **交付物范围内的缺陷修复/澄清（如文档描述与实际不一致、功能入口缺失但底座能力已具备等）**：可直接安排修复与补充说明。
2.  **新增需求/二期建设（如律师端闭环、真实支付通道、订单结算提现、会员体系、IM 私信等）**：需双方确认业务规则与合同范围后，给出评审结果、工期与成本。

本次核验结论摘要（便于贵方快速定位）：

- **律师服务（闭环）**：已实现「用户申请律师认证 → 管理员审核 → 律师工作台 → 用户预约咨询 → 生成咨询订单 → 支付（余额/支付宝配置后）→ 支付后自动确认 → 律师接单/拒单/完成 → 双方留言（非实时）→ 用户评价」的 MVP 闭环；实时 IM、排期/结算等属于二期增强。
- **支付与订单**：已具备订单模型、余额支付（可联调/可验收）、支付宝支付链接生成（需甲方提供商户参数与回调地址）、回调验签与审计留痕、对账诊断接口；微信支付回调验签/解密与平台证书管理已实现，但“发起微信支付收银台/SDK”仍需二期对接。
- **合规能力**：注册时要求勾选用户协议/隐私政策/AI 免责声明，并在后端落库记录同意版本、时间、IP、User-Agent（满足可追溯基础要求）；合规文本内容建议由甲方法务最终确认。
- **质量门禁**：已建立自动化回归与类型检查门禁；最新一次回归结果（2026-01-06）：后端 pytest 95 passed；Playwright E2E `76 passed, 0 failed`；pyright / basedpyright `0 errors/warnings`。

> 备注：本回复函为“技术与产品对照说明（2.0）”，具体里程碑、验收用例与范围边界建议在对接会议后固化到 PRD/需求确认单。

---

## 二、逐项问题回复（对照现状/缺口/建议方案/甲方需配合）

### 【问题一】律师服务模块严重不完整，无法形成业务闭环（🔴 严重）

**1) 现状说明（v1.0 交付物）**

- 已交付并可验收的 MVP 闭环能力（覆盖“预约-支付-服务-评价”的最小闭环）：
  - 用户侧：律所/律师浏览、律师认证申请、预约咨询、支付咨询订单、查看预约、取消未完成预约、与律师留言（非实时）、咨询完成后提交评价。
  - 律师侧：律师工作台查看预约列表、接单/拒单/标记完成、与用户留言（非实时）。
  - 管理端：律师认证审核（通过/驳回），以及律所/律师基础信息维护（按现有后台能力）。
- 说明：当前沟通方式采用“咨询留言线程（非实时）”实现闭环联调；实时 IM/排期/结算等属于二期增强能力。

**2) 缺口确认**

贵方列举的律师入驻、资质审核、律师主页与报价、预约排期、接单/拒单/标记完成、即时通讯、订单全链路、评价、收入提现、律师端工作台等能力：

- 其中 **认证审核、接单/拒单/完成、订单联动、留言与评价、律师工作台** 已在 v1.0 中落地并可验收。
- 仍需二期补齐/深化的部分主要包括：

  - 律师入驻/资料自助维护（头像、简介、擅长领域、报价、服务项）与权限/风控。
  - 律师排期日历与可预约时段。
  - 实时 IM/语音/视频/文件传输（或接入第三方 IM）。
  - 结算与提现、分账（如需）、发票（如需）、以及第三方支付退款自动化。

  **3) 建议解决方案（建议分期）**

为尽快实现可运营闭环，建议按 MVP → 增强 的方式推进：

- **MVP（闭环优先）**

  - 律师入驻申请（表单）
  - 管理端审核（通过/驳回）
  - 律师资料维护（基础信息、擅长领域、服务项目、价格）
  - 用户预约（选择律师、提交问题、选择服务类型/价格）
  - 律师接单/拒单/完成
  - 双方留言（非实时）
  - 用户评价

- **增强（体验与效率）**

  - 实时 IM/私信（可基于 WebSocket 或第三方 IM）
  - 律师排期日历/可预约时段
  - 律师收入与提现/结算
  - 律师端工作台（订单、排期、收益、评价管理）

  **4) 甲方需配合确认/提供**

- 律师服务交付形态：文字/电话/视频/线下等
- 计费方式：按次/按时长/按套餐/订金+尾款
- 退款规则、接单 SLA、服务完成判定标准
- 律师资质审核规则（证照类型、人工审核流程、合规要求）

**5) 建议验收路径（可操作）**

- 普通用户注册时勾选三项合规确认 → 登录。
- 进入 `/lawyer/verification` 提交律师认证申请 → 管理端 `/admin/lawyer-verifications` 审核通过。
- 用户在律所/律师详情页发起咨询预约 → 系统生成咨询订单（若律师咨询费 > 0）。
- 用户在“我的订单/我的预约”（统一入口：`/orders`）中完成支付（推荐先用余额支付联调）→ 支付后咨询状态自动变更为 `confirmed`。
- 律师登录进入 `/lawyer` 查看预约 → 可执行接单/标记完成 → 双方可在“咨询留言”中沟通 → 用户在已完成咨询上提交评价。

---

### 【问题二】支付系统仅有骨架，无法实际使用（🔴 严重）

**1) 现状说明（v1.0 交付物）**

- 已交付并可验收的部分：

  - **订单模型**：创建订单、支付订单、订单列表/详情、取消订单（待支付）.
  - **余额支付闭环**：余额账户、充值/消费/退款（余额）账本、余额支付成功后业务联动（如律师咨询订单自动确认）.
  - **第三方支付框架**：
    - 支付宝：可生成页面支付链接（需配置商户参数与回调地址）.
    - 微信：已实现 v3 回调验签/解密与平台证书管理；发起微信支付收银台需二期对接.
  - **回调审计与对账**：回调事件留痕、统计、订单对账诊断、渠道状态检查、微信平台证书刷新/离线导入.

  **2) 缺口确认**

- 仍需补齐/需要甲方配合后才能完成的部分：

  - 微信/支付宝的商户参数、证书/密钥、回调域名白名单、沙箱/生产环境策略.
  - 微信支付“发起支付”能力（APP/小程序/H5 收银台选择与 SDK/网关集成）.
  - 第三方支付退款自动化、对账报表、结算与提现、发票（如需）.

  **3) 建议解决方案（联调驱动）**

- 第一步：以“余额支付”作为可控联调链路完成全业务闭环验收（已具备）.
- 第二步：选择至少一个第三方渠道（推荐先支付宝）完成“下单 → 拉起支付 → 回调验签 → 订单置为已支付 → 业务联动”的全链路联调.
- 第三步：在业务规则明确后扩展第三方退款、结算/提现、对账报表、（可选）发票.

  **4) 甲方需配合确认/提供（对接硬前置）**

- 微信/支付宝商户参数（mch_id/app_id、证书/密钥、API key、回调域名/地址白名单等）
- 沙箱/生产环境使用要求
- 平台资金流：是否需要分账？律师结算周期与结算规则

---

### 【问题三】平台商业模式与收费功能未实现（🔴 严重）

**1) 现状说明（v1.0 交付物）**

- 已具备“收费基础设施”的可验收能力：
  - 订单模型 + 支付接口（余额支付可联调，支付宝可生成支付链接）。
  - VIP 购买/续费的 MVP：
    - 用户侧可在个人中心发起 VIP 订单并支付。
    - 支付成功后后端会自动延长 `vip_expires_at`（作为后续权益判断的载体字段）。
- 仍未固化为“可运营商业化闭环”的部分：
  - 各业务模块（AI 咨询、文书生成、律师咨询等）的计费规则、额度策略、超额处理与客服/退款口径未完成统一。
  - 当前 VIP 仅具备“购买与到期字段”，尚未对 AI/文书/律师服务做强约束扣减（需明确策略后落地）。

**2) 缺口确认**

- 统一的计费/权益模型（会员/VIP、购买包、额度扣减、有效期与续费策略）。
- 各模块收费规则落地：
  - 触发点（按次/按时长/按服务单）。
  - 限额口径（游客/登录用户/VIP 不同额度）。
  - 超额处理（限制/降级/引导购买）。
- 权益执行与审计：
  - 额度扣减幂等、审计日志、对账口径。
  - 退款与权益回滚（如需）。

**3) 建议解决方案（先方案后开发）**

建议先完成《收费策略确认单》（建议表格字段：功能模块、价格、权益定义、触发点、退款/客服口径、合规提示），再进入开发。

技术落地建议拆分为：

- 商品与权益模型（商品、权益、有效期、购买记录、发票/退款口径）。
- 权益执行（按调用扣减、幂等与审计、异常补偿）。
- 与支付订单联动（支付成功发放权益、退款回收权益）。
- 运营侧配置能力（可选）：价格/策略可配置、灰度开关与报表。

**4) 甲方需配合确认/提供**

- 价格表、权益定义、是否需要发票、退款与客服规则

---

### 【问题四】知识库/RAG 核心能力不落地（🟠 重要）

**1) 现状说明（v1.0 交付物）**

- 已交付知识库的管理与向量化相关接口/能力（工程底座）.
- 交付包内未内置完整法律法规初始数据；数据来源与更新机制需要双方明确责任边界与合法性要求.

**2) 缺口确认**

- 初始数据责任与交付方式
- 更新维护机制（自动/半自动/人工）
- 数据格式规范与导入工具的“可执行说明”

**3) 建议解决方案（两套路径供选）**

- **方案 A（甲方提供数据，我方提供导入与向量化工具）**

  - 提供数据模板（CSV/JSON）与字段规范
  - 提供导入脚本与向量化流程说明
  - 提供数据质量检查与抽样验收方法

- **方案 B（我方提供采集与自动更新能力）**
  - 需明确合法数据源、授权范围、更新频率、失败兜底、版本追踪与审计
  - 属于新增工作内容，需另行评审与报价

**4) 甲方需配合确认/提供**

- 数据来源与版权授权（或指定合规数据源）
- 更新频率与版本追踪要求
- 知识库分类体系与标签规范（如需）

---

### 【问题五】多项核心功能标注为“可选”，实际完成状态不明（🟠 重要）

我方对照交付物现状，建议按“是否具备工程底座 / 是否已产品化可用”口径进行澄清：

- **RAG 引用/检索增强**

  - 现状：具备知识库与向量化相关工程能力；效果高度依赖数据质量与配置策略.
  - 建议：若贵方要求作为 v1 必选，需要明确“默认开启策略、质量指标、数据导入与更新机制”.

- **会话导出/分享**

  - 现状：具备会话历史与分享链接相关能力基础（具体产品入口与导出格式需确认）.
  - 建议：明确需要“导出 PDF/Word”还是“分享链接”，以及权限/脱敏/有效期规则.

- **WebSocket 实时推送**
  - 现状：后端具备 WebSocket 通道能力，可用于实时通知/消息.
  - 建议：若作为必选，需要与“站内信/私信/系统通知”产品范围绑定，并明确前端交互与消息协议.

---

### 【问题六】用户端关键功能缺失（🟠 重要）

**1) 现状说明**

- 已实现并可验收的部分：
  - **合规页面与勾选**：用户协议 `/terms`、隐私政策 `/privacy`、AI 免责声明 `/ai-disclaimer`；注册时必须勾选。
  - **合规同意留痕**：后端注册接口会落库记录同意类型、版本、时间、IP、User-Agent（可追溯）。
  - **我的订单/我的预约**：提供统一入口 `/orders`（支付订单 + 律师预约），支持查看订单状态、支付（余额/支付宝）、取消未支付订单。
- 当前仍未完整覆盖/需二期补齐的部分：
  - 客服/反馈工单闭环（提交-处理-导出）。
  - 站内信/私信/实时聊天（目前律师咨询沟通为“咨询留言线程（非实时）”）。
  - 实名认证对接（如业务要求）。

**2) 建议解决方案（最小合规优先）**

- **第一优先（合规必备）**：由甲方法务确认三份合规文本的最终文案与版本号；如需“版本升级需重新同意”，建议增加“版本变更提示与强制确认”策略（可选）。
- **第二优先（运营必备）**：客服/反馈工单（最简闭环：提交-处理-导出）与后台处理台账。
- **第三优先（体验增强）**：
  - 站内信/私信（可先基于通知系统做异步消息，再升级为 WebSocket 实时）。
  - 实名认证对接（依赖第三方服务与业务规则）。

**3) 甲方需配合**

- 合规文案版本（或由贵方法务确认的文本）
- 客服处理流程与 SLA
- 实名认证是否必须、使用哪家服务商

---

### 【问题七】运营管理后台功能不完善（🟡 一般）

**现状说明**

- 已具备基础统计与部分内容管理能力，但财务统计、律师审核管理、结算管理、营销工具、报表导出等需要与“订单/支付/律师服务闭环”一起规划。

**建议**

- 将后台需求拆分为“能运营必选（审核/订单/财务基础报表）”与“提效可选（营销/更多导出）”，避免一次性大而全。

---

### 【问题八】文书生成功能不完整（🟡 一般）

**现状说明**

- 具备文书生成能力基础，但未提供历史记录、下载（Word/PDF）、在线编辑、模板后台管理等产品能力。

**建议分期**

- MVP：生成历史记录 + 下载（建议先 PDF）
- 增强：模板管理（变量化）、在线编辑、版本管理、导出 Word

---

## 三、需甲方统一确认/提供的关键资料清单（建议对接会议前准备）

1. **律师服务业务规则**：服务类型、定价、接单 SLA、退款规则、完成标准、资质审核规则。
2. **支付对接资料**：微信/支付宝商户参数、证书/密钥、回调地址白名单、沙箱/生产环境要求、是否分账。
3. **商业化策略**：会员体系是否需要、权益与价格表、免费额度策略、超额处理策略。
4. **合规文本**：用户协议、隐私政策、AI 免责声明（由甲方确认的最终版本）。
5. **知识库数据**：数据来源/授权、初始数据提供方式、更新频率与版本追踪要求。

---

## 四、建议的技术对接会议与产出

**建议会议时长：** 60–90 分钟（产品 + 技术 + 运营）

**建议议题：**

- 律师服务闭环（流程图、状态机、角色权限）
- 支付与订单（支付通道、回调幂等、退款、对账）
- 商业化（会员/权益/额度扣减）
- RAG 数据（数据规范、导入、更新责任）
- 合规（页面与勾选确认流程）

**会议产出：**

- 需求确认单/PRD（含范围边界）
- API/数据模型清单
- 里程碑计划与验收用例

---

## 五、结束语

我方愿与贵方共同推进项目顺利落地。建议在确认合同范围与业务规则后，我方将提供：

- 每项问题的“是否范围内/是否新增”结论
- 对应的开发排期与工作量评估
- 可执行的验收标准

**联系人：** [填写]  
**电话：** [填写]  
**邮箱：** [填写]

---
